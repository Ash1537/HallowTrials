<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Hallow Trials — Enter if you dare</title>
  <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Inter:wght@300;500;700&display=swap" rel="stylesheet">
  <style>
    :root{--bg:#0a0a0f;--bg-2:#0f0a12;--ink:#e6e3ff;--ash:#9a94b8;--blood:#b10f2e;--ecto:#6b4dff;--card:#121018;--max:1400px}
    *{box-sizing:border-box;margin:0;padding:0}
    body{margin:0;font-family:Inter,sans-serif;color:var(--ink);background:linear-gradient(180deg,var(--bg),var(--bg-2));min-height:100vh;display:flex;flex-direction:column}
    a{color:inherit;text-decoration:none}

    header{position:sticky;top:0;z-index:30;background:rgba(10,10,15,.9);backdrop-filter:blur(6px);border-bottom:1px solid rgba(255,255,255,.05)}
    nav{max-width:var(--max);margin:0 auto;display:flex;align-items:center;gap:24px;padding:20px 32px;width:100%}
    .brand{font-family:Cinzel,serif;letter-spacing:3px;font-weight:700;font-size:22px;color:var(--ink)}
    .brand .glyph{color:var(--blood)}
    .navlinks{margin-left:auto;display:flex;gap:28px;flex-wrap:wrap}
    .navlinks a{opacity:.9;text-decoration:none;font-weight:500;color:var(--ink);transition:.2s}
    .navlinks a:hover{color:var(--blood)}

    section{width:100%;display:flex;flex-direction:column;justify-content:center;align-items:center;padding:80px 20px}

    .hero{flex-direction:row;max-width:var(--max);gap:60px;align-items:center;margin:0 auto;min-height:100vh}
    .hero>div{flex:1}
    .title{font-family:Cinzel,serif;font-size:clamp(42px,6vw,80px);margin:0 0 20px;text-shadow:0 0 40px rgba(107,77,255,.35);position:relative;display:inline-block}
    .subtitle{color:var(--ash);margin-bottom:24px;line-height:1.6;font-size:18px}
    .cta{display:flex;gap:16px;flex-wrap:wrap}
    .btn{border:none;background:linear-gradient(180deg,#1c1529,#0f0a14);color:var(--ink);padding:14px 24px;border-radius:14px;cursor:pointer;font-weight:600;transition:.2s}
    .btn:hover{background:#2a1c3d;color:#fff}

    .panel{
      background:var(--card);
      border:1px solid rgba(255,255,255,.08);
      border-radius:20px;
      padding:32px;
      flex:1;
      box-shadow:0 10px 30px rgba(0,0,0,.6);
      position:relative;
      overflow:visible;
    }
    .panel h3{font-family:Cinzel,serif;font-size:24px;margin-bottom:16px}
    .panel::before,.panel::after{
      content:"";position:absolute;top:-26px;width:80px;height:80px;opacity:.55;pointer-events:none;
      background:url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='80' height='80' viewBox='0 0 80 80'><g fill='none' stroke='%23bfb9ff' stroke-opacity='.6'><path d='M0 80C0 53 27 26 54 26M0 80C0 41 39 2 78 2M0 80C0 65 15 50 30 50'/><path d='M0 80L0 0 80 0'/><path d='M0 56Q20 56 28 48'/><path d='M0 32Q38 32 56 14'/></g></svg>") center/contain no-repeat;
      filter:drop-shadow(0 4px 12px rgba(0,0,0,.4));
    }
    .panel::before{left:-22px}
    .panel::after{right:-22px;transform:scaleX(-1)}

    /* Eyes */
    .eyes{position:absolute;width:64px;height:26px;transform:rotate(-10deg);pointer-events:none;opacity:.9;filter:drop-shadow(0 2px 10px rgba(0,0,0,.35));animation:eyes-bob 5s ease-in-out infinite}
    .eye{position:absolute;bottom:0;width:26px;height:16px;background:var(--ink);border-radius:16px 16px 6px 6px;overflow:hidden}
    .eye + .eye{left:38px}
    .eye i{position:absolute;top:4px;left:6px;width:8px;height:8px;border-radius:50%;background:#1a1530;animation:eyes-look 4.6s ease-in-out infinite}
    .eye::before{content:"";position:absolute;left:0;right:0;top:0;height:100%;background:linear-gradient(to bottom,var(--bg-2),var(--bg));transform-origin:top;transform:scaleY(0);animation:eyes-blink 6.5s infinite;opacity:.96;mix-blend-mode:multiply}
    @keyframes eyes-look{0%,15%{transform:translateX(0)}30%,45%{transform:translateX(6px)}60%,75%{transform:translateX(-3px)}90%,100%{transform:translateX(0)}}
    @keyframes eyes-blink{0%,6%,100%{transform:scaleY(0)}2%{transform:scaleY(1)}50%{transform:scaleY(0)}52%{transform:scaleY(1)}54%{transform:scaleY(0)}}
    @keyframes eyes-bob{0%,100%{transform:translateY(0) rotate(-10deg)}50%{transform:translateY(2px) rotate(-10deg)}}

    /* ===== Countdown (replaces Games) ===== */
    #countdown{min-height:100vh;gap:28px}
    .cd-wrap{max-width:var(--max);margin:0 auto;display:grid;grid-template-columns:1.1fr .9fr;gap:40px;align-items:center}
    .cd-left{width:100%}
    .cd-title{font-family:Cinzel,serif;font-size:clamp(34px,5.5vw,70px);line-height:1.05;text-align:left}
    .cd-sub{color:var(--ash);margin-top:10px}
    .tiles{display:grid;grid-template-columns:repeat(4,minmax(120px,1fr));gap:14px;margin-top:24px}
    .tile{background:radial-gradient(160% 120% at 50% 0%, #1b1324 0%, #110c16 50%, #0d0b12 100%);border:1px solid rgba(255,255,255,.08);border-radius:18px;box-shadow:0 10px 30px rgba(0,0,0,.55), inset 0 0 40px rgba(177,15,46,.08);padding:18px;text-align:center;position:relative;overflow:hidden}
    .tile .num{font-feature-settings:"tnum" 1; font-variant-numeric:tabular-nums; font-weight:700; font-size:clamp(34px,6vw,60px); letter-spacing:1px; text-shadow:0 0 24px rgba(255,0,60,.25)}
    .tile .lbl{color:var(--ash);font-size:13px;letter-spacing:.2px;margin-top:6px}
    .tile::after{content:"";position:absolute;inset:-30% -10% auto -10%;height:60%;background:radial-gradient(120px 60px at 30% 0, rgba(255,255,255,.06), transparent 60%);filter:blur(10px)}
    .flicker{animation:flick .9s infinite steps(2,end)}
    @keyframes flick{0%,100%{opacity:1}50%{opacity:.72}}

    .cd-right{position:relative;border-radius:20px;border:1px solid rgba(255,255,255,.08);overflow:hidden;box-shadow:0 20px 40px rgba(0,0,0,.6)}
    .cd-right::before{content:"";position:absolute;inset:0; background:
      url('https://images.unsplash.com/photo-1534088568595-a066f410bcda?q=80&w=1600&auto=format&fit=crop') center/cover no-repeat;}
    .cd-right::after{content:"";position:absolute;inset:0;background:radial-gradient(120% 100% at 60% -10%, rgba(107,77,255,.14), transparent 50%), linear-gradient(180deg, rgba(0,0,0,.55), rgba(0,0,0,.75));}
    .drip{position:absolute;top:-10px;left:0;right:0;height:26px;background:
      radial-gradient(14px 16px at 6% 10px, var(--blood) 60%, transparent 61%) 0 0/80px 26px repeat-x,
      linear-gradient(var(--blood),var(--blood)) 0 0/100% 12px no-repeat;opacity:.6;filter:blur(.2px)}
    .cd-note{position:absolute;bottom:16px;left:16px;color:#e9d6ff;opacity:.85;text-shadow:0 2px 10px #000}

    /* Short Video */
    .short-video{flex-direction:row;max-width:var(--max);gap:60px;align-items:center;margin:0 auto;min-height:100vh}
    .short-video-text{flex:1}
    .short-video-text h3{font-family:Cinzel,serif;font-size:clamp(32px,4vw,44px);margin-bottom:16px}
    .short-video-text p{color:var(--ash);line-height:1.7;font-size:18px}
    .short-video-card{flex:1;position:relative;overflow:hidden;border-radius:20px;border:1px solid rgba(255,255,255,.08);background:#0f0a14;box-shadow:0 20px 40px rgba(0,0,0,.6)}
    .short-video-card video{display:block;width:100%;height:100%;object-fit:cover;border-radius:20px}

    /* ========== PUZZLE ========== */
    #puzzle{max-width:var(--max);margin:0 auto;gap:28px}
    .puzzle-intro{max-width:820px;text-align:center;color:var(--ash)}
    .puzzle-intro strong{color:var(--ink)}
    .codebar{display:flex;gap:10px;flex-wrap:wrap;justify-content:center;margin-top:14px}
    .codebar input{background:#0b0b12;border:1px solid rgba(255,255,255,.12);color:var(--ink);padding:12px 14px;border-radius:12px;min-width:260px;text-transform:uppercase;letter-spacing:1px}
    .codebar button{background:#1c1529;border:1px solid rgba(255,255,255,.14);color:var(--ink);padding:12px 16px;border-radius:12px;cursor:pointer}
    .codebar button:hover{background:#281c3d}
    .progress-note{margin-top:6px;color:var(--ash);font-size:14px;text-align:center}

    .chest-grid{width:100%;display:grid;gap:18px;margin-top:26px;grid-template-columns:repeat(3,minmax(220px,1fr))}
    .chest{position:relative;aspect-ratio:1/1;background:#0f0a14;border:1px solid rgba(255,255,255,.08);border-radius:16px;overflow:hidden;display:flex;align-items:center;justify-content:center;box-shadow:0 10px 30px rgba(0,0,0,.4);transition:transform .12s ease}
    .chest:hover{transform:translateY(-2px)}
    .chest .reveal{position:absolute;inset:0;display:flex;flex-direction:column;align-items:center;justify-content:flex-end;gap:10px;padding:12px}
    .reveal img{position:absolute;inset:0;width:100%;height:100%;object-fit:cover;transition:opacity .35s ease, transform .35s ease;filter:grayscale(.15) contrast(1.05) brightness(.9)}
    .chest.locked .reveal img{opacity:0;visibility:hidden;transform:scale(1.05)}
    .chest.locked .label-title{opacity:.85;letter-spacing:.4px}
    .chest.unlocked .reveal img{opacity:1;visibility:visible;transform:scale(1)}
    .reveal .label{position:relative;z-index:1;background:rgba(0,0,0,.55);border:1px solid rgba(255,255,255,.2);color:var(--ink);padding:8px 10px;border-radius:10px;text-align:center;width:100%;font-weight:600;text-shadow:0 2px 8px rgba(0,0,0,.6)}
    .reveal .label .room{font-size:12px;opacity:.85}

    /* Chains/lock overlay — with ☠ text skull */
    .pad{
      position:absolute; inset:0; pointer-events:none;
      transition:opacity .45s ease, transform .45s ease;
      background:
        radial-gradient(140% 80% at 50% 10%, rgba(0,0,0,.45) 0%, rgba(0,0,0,0) 40%),
        linear-gradient(180deg,#1a1410 0%, #120e0b 100%);
      border-radius:14px;
      background-image:
        url("data:image/svg+xml;utf8,\
          <svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512'>\
            <defs>\
              <linearGradient id='wood' x1='0' y1='0' x2='0' y2='1'>\
                <stop offset='0' stop-color='%23201812'/>\
                <stop offset='1' stop-color='%23140f0b'/>\
              </linearGradient>\
              <linearGradient id='chain' x1='0' y1='0' x2='1' y2='1'>\
                <stop offset='0' stop-color='%236a3f22'/>\
                <stop offset='1' stop-color='%23804f28'/>\
              </linearGradient>\
              <filter id='soft' x='-20%' y='-20%' width='140%' height='140%'>\
                <feDropShadow dx='0' dy='2' stdDeviation='5' flood-color='black' flood-opacity='.55'/>\
              </filter>\
            </defs>\
            <rect width='512' height='512' fill='url(%23wood)'/>\
            <g opacity='.08' stroke='%23a07a53'>\
              <path d='M0 96H512M0 192H512M0 288H512M0 384H512'/>\
            </g>\
            <g stroke='url(%23chain)' stroke-width='42' stroke-linecap='round' filter='url(%23soft)' fill='none'>\
              <path d='M40 60 L472 452'/>\
              <path d='M40 452 L472 60'/>\
            </g>\
            <circle cx='256' cy='256' r='84' fill='%2315100d' stroke='%23573a24' stroke-width='18'/>\
            <text x='50%' y='268' text-anchor='middle' font-size='80' fill='%23d7c6a8' font-family='serif'>☠</text>\
            <g stroke='%23cfc7ff' stroke-opacity='.25' stroke-width='2'>\
              <path d='M24 120Q80 120 112 88M24 160Q96 160 152 104'/>\
              <path d='M360 56Q408 88 488 92M336 88Q420 120 488 128'/>\
            </g>\
          </svg>");
      background-size: cover;
      animation: padPulse 2.6s ease-in-out infinite;
    }
    .pad::after{
      content:""; position:absolute; inset:0; pointer-events:none; opacity:.18;
      background:
        radial-gradient(400px 300px at 12% 8%, rgba(213,209,255,.15), transparent 60%),
        radial-gradient(360px 280px at 88% 12%, rgba(213,209,255,.14), transparent 60%);
    }
    .chest.locked .pad{opacity:.99}
    .chest.unlocked .pad{opacity:0}
    @keyframes padPulse{0%,100%{filter:brightness(1) saturate(1)}50%{filter:brightness(1.08) saturate(1.05)}}

    .chest.unlocking .pad{animation:pad-break .7s ease forwards}
    @keyframes pad-break{
      0%{opacity:1;transform:scale(1)}
      40%{transform:scale(1.06) rotate(2deg)}
      60%{transform:scale(1.12) rotate(-3deg)}
      100%{opacity:0;transform:scale(1.18) rotate(-6deg)}
    }

    .toast{margin-top:10px;color:#9dffc4;display:none}
    .shake{animation:shake .25s}
    @keyframes shake{0%,100%{transform:translateX(0)}25%{transform:translateX(-5px)}75%{transform:translateX(5px)}}

    @media(max-width:1100px){.cd-wrap{grid-template-columns:1fr}.cd-title{text-align:center}.cd-left{order:2}.cd-right{order:1;height:360px;width:100%}.tiles{grid-template-columns:repeat(4,1fr)}}
    @media(max-width:1024px){.hero,.short-video{flex-direction:column;text-align:center;min-height:auto;padding:60px 20px}.panel{width:100%;margin-top:20px}}
    @media(max-width:768px){
      nav{flex-direction:column;align-items:center;gap:12px}
      .title{font-size:clamp(32px,8vw,56px)}
      .short-video-text h3{font-size:28px}
      .chest-grid{grid-template-columns:repeat(2,minmax(180px,1fr))}
    }
    @media(max-width:560px){.tiles{grid-template-columns:repeat(2,1fr)}}
    @media(max-width:480px){.chest-grid{grid-template-columns:1fr}}
  </style>
</head>
<body>
  <header>
    <nav>
      <div class="brand"><span class="glyph">◆</span> HALLOW TRIALS</div>
      <div class="navlinks">
        <a href="#countdown">Countdown</a>
        <a href="#video">Short Video</a>
        <a href="#puzzle">Puzzle</a>
      </div>
    </nav>
  </header>

  <section class="hero">
    <div style="position:relative">
      <h1 class="title">Enter the <span style="color:var(--blood);position:relative;">Trials
        <div class="eyes" style="top:-20px;left:10px;"><span class="eye"><i></i></span><span class="eye"><i></i></span></div>
        <div class="eyes" style="top:-10px;left:80px;"><span class="eye"><i></i></span><span class="eye"><i></i></span></div>
        <div class="eyes" style="top:-5px;left:160px;"><span class="eye"><i></i></span><span class="eye"><i></i></span></div>
      </span></h1>
      <p class="subtitle">A one-night pop-up where we unleash handcrafted spooky mini-games. Play them on site, watch our behind-the-scenes shorts, and crack the hidden codes woven into this very page.</p>
      <div class="cta">
        <a class="btn" href="#countdown">See the Countdown</a>
        <a class="btn" href="#video">Watch the Short</a>
        <a class="btn" href="#puzzle">Solve the Puzzle</a>
      </div>
    </div>

    <div class="panel">
      <h3>Event Details</h3>
      <p><strong>Date:</strong> 31 Oct, 7:00PM — Midnight</p><br>
      <p><strong>Venue:</strong> The Old Mill Warehouse</p><br>
      <p><strong>What to expect:</strong> 6 eerie arcade cabinets, live screams, candy, and a site-wide code hunt.</p>
    </div>
  </section>

  <!-- ===== Countdown section ===== -->
  <section id="countdown">
    <div class="cd-wrap">
      <div class="cd-left">
        <h2 class="cd-title">The <span style="color:var(--blood)">Hallow Trials</span> begin in…</h2>
        <p class="cd-sub">Doors creak at <strong>7:00 PM</strong> on Halloween night. When the clock hits zero, the warehouse opens.</p>
        <div class="tiles" role="timer" aria-live="polite">
          <div class="tile"><div class="num" id="dd">—</div><div class="lbl">Days</div></div>
          <div class="tile"><div class="num" id="hh">—</div><div class="lbl">Hours</div></div>
          <div class="tile"><div class="num" id="mm">—</div><div class="lbl">Minutes</div></div>
          <div class="tile"><div class="num flicker" id="ss">—</div><div class="lbl">Seconds</div></div>
        </div>
      </div>
      <div class="cd-right">
        <div class="drip" aria-hidden="true"></div>
        <div class="cd-note">“When the last second dies… enter.”</div>
      </div>
    </div>
  </section>

  <section id="video" class="short-video">
    <div class="short-video-text">
      <h3>Short Video</h3>
      <p>Get a sneak peek into the haunted halls. Watch this teaser to feel the chill before you enter the Trials.</p>
    </div>
    <div class="short-video-card">
      <video id="teaser" controls>
        <source src="video.mp4" type="video/mp4" />
        Sorry, your browser doesn’t support embedded videos.
      </video>
    </div>
  </section>

  <!-- ========== PUZZLE ========== -->
  <section id="puzzle">
    <h2 class="title" style="font-size:clamp(34px,4.6vw,56px);text-align:center;">Site-Wide Puzzle: <span style="color:var(--blood)">Find & Unlock</span></h2>
    <p class="puzzle-intro">
      Hunt the campus for hidden codes. Each correct code unlocks a chained chest below and reveals one of the games we’ll run that night.
      Enter codes in <strong>any order</strong>. Progress is saved on your device.
    </p>
    <div class="codebar">
      <input id="codeInput" placeholder="ENTER CODE" autocomplete="off" spellcheck="false" />
      <button id="submitCode">Unlock</button>
      <button id="resetCodes" title="Clear local progress">Reset</button>
    </div>
    <div class="progress-note" id="progressNote">0 / 9 unlocked</div>

    <div class="chest-grid" id="chestGrid"></div>
    <div class="toast" id="toast"></div>
  </section>

  <script>
    /* ===== Countdown logic ===== */
    function nextHalloween(year){
      const d = new Date(year, 9, 31, 19, 0, 0); // Oct=9, 7:00 PM local
      return d;
    }
    (function runCountdown(){
      const now = new Date();
      let target = nextHalloween(now.getFullYear());
      if (now > target) target = nextHalloween(now.getFullYear()+1);

      const dd = document.getElementById('dd');
      const hh = document.getElementById('hh');
      const mm = document.getElementById('mm');
      const ss = document.getElementById('ss');

      function tick(){
        const t = target - new Date();
        if (t <= 0){
          dd.textContent = '00'; hh.textContent='00'; mm.textContent='00'; ss.textContent='00';
          document.querySelector('#countdown .cd-title').innerHTML = 'The doors are <span style="color:var(--blood)">OPEN</span>.';
          return;
        }
        const d = Math.floor(t/86400000);
        const h = Math.floor((t%86400000)/3600000);
        const m = Math.floor((t%3600000)/60000);
        const s = Math.floor((t%60000)/1000);
        dd.textContent = String(d).padStart(2,'0');
        hh.textContent = String(h).padStart(2,'0');
        mm.textContent = String(m).padStart(2,'0');
        ss.textContent = String(s).padStart(2,'0');
        requestAnimationFrame(()=>setTimeout(tick, 250));
      }
      tick();
    })();

    /* --------- PUZZLE DATA (edit codes/images/names here) --------- */
    const PUZZLE = [
      {id:1, code:'SHADOW-31', title:'Echo Trail',  room:'E-09-06', img:'https://images.unsplash.com/photo-1500530855697-b586d89ba3ee?q=80&w=1200&auto=format&fit=crop'},
      {id:2, code:'SILENCE-09', title:'Silence Room', room:'D-09-06', img:'https://images.unsplash.com/photo-1482192505345-5655af888cc4?q=80&w=1200&auto=format&fit=crop'},
      {id:3, code:'TAPE-02', title:'Cassette', room:'E-09-02', img:'https://images.unsplash.com/photo-1548611716-0fae2c7d4d1c?q=80&w=1200&auto=format&fit=crop'},
      {id:4, code:'LIGHT-08', title:'Light of Death', room:'D-08-08', img:'https://images.unsplash.com/photo-1501785888041-af3ef285b470?q=80&w=1200&auto=format&fit=crop'},
      {id:5, code:'MAP-01', title:'Map of Doom', room:'E-08-01', img:'https://images.unsplash.com/photo-1500534314209-a25ddb2bd429?q=80&w=1200&auto=format&fit=crop'},
      {id:6, code:'CURSE-07', title:'The Curse', room:'Level 7 (Block E→D, Every Class)', img:'https://images.unsplash.com/photo-1469474968028-56623f02e42e?q=80&w=1200&auto=format&fit=crop'},
      {id:7, code:'JIANGSHI-01', title:'Jiangshi', room:'S-08-01', img:'https://images.unsplash.com/photo-1504194104404-433180773017?q=80&w=1200&auto=format&fit=crop'},
      {id:8, code:'DOORS-3', title:'Three Doors', room:'E-08-11 / S-08-05 / S-08-06 / S-08-07', img:'https://images.unsplash.com/photo-1523419409543-8f6f2f2a6f58?q=80&w=1200&auto=format&fit=crop'},
      {id:9, code:'RUSSIAN-07', title:'Russian Roulette', room:'S-07-02', img:'https://images.unsplash.com/photo-1519681393784-d120267933ba?q=80&w=1200&auto=format&fit=crop'}
    ];

    const GRID = document.getElementById('chestGrid');
    const input = document.getElementById('codeInput');
    const submit = document.getElementById('submitCode');
    const reset = document.getElementById('resetCodes');
    const toast = document.getElementById('toast');
    const note  = document.getElementById('progressNote');

    const KEY = 'hallow-unlocked-v1';
    let unlocked = new Set(JSON.parse(localStorage.getItem(KEY) || '[]'));

    function renderGrid(){
      GRID.innerHTML = '';
      PUZZLE.forEach(item=>{
        const isOpen = unlocked.has(item.code);
        const card = document.createElement('div');
        card.className = `chest ${isOpen?'unlocked':'locked'}`;
        card.dataset.code = item.code;
        card.innerHTML = `
          <div class="pad" aria-hidden="true"></div>
          <div class="reveal">
            <img src="${item.img}" alt="${item.title}" loading="lazy">
            <div class="label">
              <div class="label-title">${isOpen?item.title:'LOCKED'}</div>
              <div class="room">${isOpen?item.room:'Find the code'}</div>
            </div>
          </div>
        `;
        GRID.appendChild(card);
      });
      note.textContent = `${unlocked.size} / ${PUZZLE.length} unlocked`;
    }
    renderGrid();

    function showToast(msg, ok=false){
      toast.textContent = msg;
      toast.style.display = 'block';
      toast.style.color = ok ? '#9dffc4' : '#ffb3b3';
      setTimeout(()=>toast.style.display='none', 1800);
    }

    function tryCode(){
      const raw = input.value.trim().toUpperCase();
      if(!raw) return;
      const match = PUZZLE.find(x => x.code.toUpperCase() === raw);
      if(!match){
        input.classList.add('shake'); setTimeout(()=>input.classList.remove('shake'), 260);
        showToast('Nope. Keep searching.');
        return;
      }
      if(unlocked.has(match.code)){
        showToast('Already unlocked.', true);
        input.value = '';
        return;
      }

      const card = [...GRID.children].find(el => el.dataset.code === match.code);
      if(card){
        card.classList.add('unlocking');
        setTimeout(()=>{
          unlocked.add(match.code);
          localStorage.setItem(KEY, JSON.stringify(Array.from(unlocked)));
          card.classList.remove('unlocking','locked');
          card.classList.add('unlocked');
          card.querySelector('.label-title').textContent = match.title;
          card.querySelector('.room').textContent = match.room;
          showToast(`Unlocked: ${match.title}!`, true);
          note.textContent = `${unlocked.size} / ${PUZZLE.length} unlocked`;
        }, 720);
      } else {
        unlocked.add(match.code);
        localStorage.setItem(KEY, JSON.stringify(Array.from(unlocked)));
        renderGrid();
      }
      input.value = '';
    }

    submit.addEventListener('click', tryCode);
    input.addEventListener('keydown', (e)=>{ if(e.key==='Enter') tryCode(); });
    reset.addEventListener('click', ()=>{
      localStorage.removeItem(KEY);
      unlocked = new Set();
      renderGrid();
      showToast('Progress reset.');
    });
  </script>
</body>
</html>
